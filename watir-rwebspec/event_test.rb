load File.dirname(__FILE__) + '/test_helper.rb'

test_suite "Events" do
  include TestHelper

  before(:all) do
    open_browser
    reset_database
    failsafe{ logout }
    login_as("admin")
  end


  before(:each) do
    visit "/"
    refresh # if is IE?
  end

  after(:all) do
   logout unless debugging?
  end

  # Press key Ctrl+Shift+T, then enter 123 quickly navigate you here
  story "[5] Can create a new event" do
    try { click_link("Events") }
    event_list_page = expect_page EventListPage
    event_page = event_list_page.click_new
    event_page.enter_name("ABA Workshop")
    event_page.enter_venue("QUT")
    event_page.enter_presenters("Many")
    event_page.enter_date("10/12/2010")
    event_page.click_create
    goto_page("/events")
    assert_text_present("3 events")
  end
#
  test "[6] Can edit an existing event" do
    click_link("Events")
    event_list_page = expect_page EventListPage
    event_page = event_list_page.edit(0)
    event_page.enter_name("2010 Agileway Testing Conference")
    event_page.enter_date_from("2011-07-27")
    event_page.click_save
    assert_text_present("2010 Agileway Testing Conference")
    click_link("Events")
    refresh # if ie
    page_text.should contain("2011-07-27")
  end


end
